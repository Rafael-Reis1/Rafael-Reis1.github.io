<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="App de gerenciamento de finan√ßas pessoais - Controle suas receitas e despesas">
    <title>Financeiro Pessoal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js" defer></script>
</head>

<body>
    <div id="offlineBadge" class="offline-badge">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="1" y1="1" x2="23" y2="23"></line>
            <path d="M16.72 11.06A10.94 10.94 0 0 1 19 12.55"></path>
            <path d="M5 12.55a10.94 10.94 0 0 1 5.17-2.39"></path>
            <path d="M10.71 5.05A16 16 0 0 1 22.58 9"></path>
            <path d="M1.42 9a15.91 15.91 0 0 1 4.7-2.88"></path>
            <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
            <line x1="12" y1="20" x2="12.01" y2="20"></line>
        </svg>
        <span>Sem conex√£o</span>
    </div>
    <div class="app-container">
        <header class="header">
            <div class="header-left">
                <a href="../index.html" class="btn-back" title="Voltar ao Portfolio">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7" />
                    </svg>
                </a>
                <h1>üí∞ Financeiro Pessoal</h1>
            </div>
            <div class="header-actions">
                <button id="btnLogin" class="btn btn-secondary" title="Login com Google" style="display: none;">
                    <svg width="18" height="18" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"
                        fill="currentColor">
                        <path
                            d="M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .533 5.347.533 12S5.867 24 12.48 24c3.44 0 6.013-1.133 8.013-3.227 2.04-2.053 2.627-5.067 2.627-7.427 0-.747-.054-1.467-.16-2.147H12.48z" />
                    </svg>
                    <span id="loginText">Google Login</span>
                </button>
                <div id="userInfo" class="user-info" style="display: none;">
                    <img id="userAvatar" src="" alt="User" class="user-avatar" title="Clique para op√ß√µes">
                    <div id="userDropdown" class="user-dropdown">
                        <div class="dropdown-header">
                            <span id="userName" class="user-name">Usu√°rio</span>
                            <span id="userEmail" class="user-email">email@exemplo.com</span>
                        </div>
                        <div class="dropdown-divider"></div>
                        <button id="btnExportMenu" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            Exportar Backup
                        </button>
                        <button id="btnImportMenu" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            Importar Backup
                        </button>
                        <div class="dropdown-divider"></div>
                        <button id="btnLogout" class="dropdown-item danger">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                <polyline points="16 17 21 12 16 7"></polyline>
                                <line x1="21" y1="12" x2="9" y2="12"></line>
                            </svg>
                            Sair
                        </button>
                    </div>
                </div>
                <button id="btnImport" class="btn btn-secondary" title="Importar dados" style="display: none;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                        <polyline points="17 8 12 3 7 8" />
                        <line x1="12" y1="3" x2="12" y2="15" />
                    </svg>
                    <span>Importar</span>
                </button>
                <button id="btnExport" class="btn btn-secondary" title="Exportar dados" style="display: none;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                        <polyline points="7 10 12 15 17 10" />
                        <line x1="12" y1="15" x2="12" y2="3" />
                    </svg>
                    <span>Exportar</span>
                </button>
                <input type="file" id="fileInput" accept=".json" hidden>
            </div>
        </header>

        <main class="main-content">
            <section class="dashboard">
                <div class="card summary-card balance">
                    <div class="card-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="2" y="4" width="20" height="16" rx="2" />
                            <path d="M12 12a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                            <path d="M2 10h2M20 10h2" />
                        </svg>
                    </div>
                    <div class="card-content">
                        <span class="card-label">Saldo Atual</span>
                        <span class="card-value" id="balanceValue">R$ 0,00</span>
                    </div>
                </div>
                <div class="card summary-card income">
                    <div class="card-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="12" y1="19" x2="12" y2="5" />
                            <polyline points="5 12 12 5 19 12" />
                        </svg>
                    </div>
                    <div class="card-content">
                        <span class="card-label" id="incomeLabel">Receitas (m√™s)</span>
                        <span class="card-value" id="incomeValue">R$ 0,00</span>
                    </div>
                </div>
                <div class="card summary-card expense">
                    <div class="card-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <polyline points="19 12 12 19 5 12" />
                        </svg>
                    </div>
                    <div class="card-content">
                        <span class="card-label" id="expenseLabel">Despesas (m√™s)</span>
                        <span class="card-value" id="expenseValue">R$ 0,00</span>
                    </div>
                </div>
                <div class="card summary-card future">
                    <div class="card-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </div>
                    <div class="card-content">
                        <span class="card-label">A Pagar (Futuro)</span>
                        <span class="card-value" id="futureValue">R$ 0,00</span>
                    </div>
                </div>
            </section>

            <div class="content-grid">
                <section class="card chart-section">
                    <h2 class="section-title">Despesas por Categoria</h2>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                        <p id="noChartData" class="no-data-message">Adicione despesas para ver o gr√°fico</p>
                    </div>
                </section>

                <section class="card chart-section">
                    <h2 class="section-title">Receitas por Categoria</h2>
                    <div class="chart-container">
                        <canvas id="incomeChart"></canvas>
                        <p id="noIncomeData" class="no-data-message">Adicione receitas para ver o gr√°fico</p>
                    </div>
                </section>
            </div>

            <section class="card transactions-section">
                <div class="section-header">
                    <div class="section-title-row">
                        <h2 class="section-title">Transa√ß√µes</h2>
                        <button id="btnAddTransaction" class="btn btn-primary">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19" />
                                <line x1="5" y1="12" x2="19" y2="12" />
                            </svg>
                            <span>Adicionar</span>
                        </button>
                    </div>
                    <div class="filters">
                        <input type="text" id="searchInput" class="search-input" placeholder="üîç Pesquisar...">
                        <button id="btnOpenFilters" class="btn btn-secondary" title="Filtros"
                            style="min-width: unset; padding: 0 1rem;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                            </svg>
                        </button>
                    </div>
                </div>
                <div id="activeFilters" class="active-filters">
                </div>
                <div class="transactions-list" id="transactionsList">
                </div>

                <div id="paginationControls" class="pagination-controls" style="display: none;">
                    <button id="btnPrevPage" class="btn btn-secondary btn-sm" disabled>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                        Anterior
                    </button>
                    <span id="pageInfo" class="page-info">P√°gina 1</span>
                    <button id="btnNextPage" class="btn btn-secondary btn-sm">
                        Pr√≥ximo
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="9 18 15 12 9 6"></polyline>
                        </svg>
                    </button>
                </div>

                <div id="noTransactions" class="empty-state" style="display: none;">
                    <h3>Nenhuma transa√ß√£o ainda</h3>
                    <p>Clique em "+ Nova Transa√ß√£o" para come√ßar a controlar seus gastos!</p>
                </div>
            </section>
        </main>
    </div>

    <div id="loginOverlay" class="login-overlay">
        <div class="login-card">
            <div id="authLoading" class="auth-loading">
                <div class="spinner"></div>
                <p>Carregando p√°gina...</p>
            </div>
            <div id="authContent" class="auth-content" style="display: none;">
                <div class="login-icon">
                    <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="1.5">
                        <rect x="2" y="4" width="20" height="16" rx="2" />
                        <line x1="12" y1="16" x2="12" y2="12" />
                        <line x1="12" y1="8" x2="12.01" y2="8" />
                    </svg>
                </div>
                <h2>Bem-vindo ao Financeiro Pessoal</h2>
                <p>Para sincronizar seus dados em todos os dispositivos com seguran√ßa, √© necess√°rio fazer login com sua
                    conta Google.</p>
                <p class="login-note">Este aplicativo n√£o armazena dados locais para garantir que suas finan√ßas estejam
                    sempre atualizadas na nuvem.</p>
                <button id="btnLoginOverlay" class="btn btn-primary btn-lg">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .533 5.347.533 12S5.867 24 12.48 24c3.44 0 6.013-1.133 8.013-3.227 2.04-2.053 2.627-5.067 2.627-7.427 0-.747-.054-1.467-.16-2.147H12.48z" />
                    </svg>
                    Fazer Login com Google
                </button>
                <a href="../index.html" class="btn btn-text-only"
                    style="color: var(--text-muted); text-decoration: none; font-size: 0.9rem;">
                    Voltar para o Portfolio
                </a>
            </div>
        </div>
    </div>

    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Nova Transa√ß√£o</h3>
                <button class="modal-close" id="closeEditModal">&times;</button>
            </div>
            <form id="editForm">
                <input type="hidden" id="editId">
                <div class="form-group">
                    <label for="editDescription">Descri√ß√£o</label>
                    <input type="text" id="editDescription" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editAmount">Valor (R$)</label>
                        <input type="text" id="editAmount" inputmode="numeric" placeholder="0,00" required>
                    </div>
                    <div class="form-group">
                        <label for="editDate">Data</label>
                        <input type="date" id="editDate" required>
                    </div>
                    <div class="form-group checkbox-group">
                        <label class="custom-checkbox-container">
                            <input type="checkbox" id="isRecurring">
                            <span class="custom-checkmark"></span>
                            <span class="checkbox-label">Parcelar?</span>
                        </label>
                    </div>
                </div>

                <div id="recurringOptions" class="form-row" style="display: none;">
                    <div class="form-group full-width">
                        <label for="recurringInstallments">N√∫mero de Parcelas</label>
                        <input type="number" id="recurringInstallments" placeholder="Ex: 12" min="2">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="editType">Tipo</label>
                        <select id="editType" required>
                            <option value="expense">Despesa</option>
                            <option value="income">Receita</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editCategory">Categoria</label>
                        <select id="editCategory" required>
                            <optgroup label="Despesas">
                                <option value="alimentacao">üçî Alimenta√ß√£o</option>
                                <option value="transporte">üöó Transporte</option>
                                <option value="moradia">üè† Moradia</option>
                                <option value="saude">üíä Sa√∫de</option>
                                <option value="educacao">üìö Educa√ß√£o</option>
                                <option value="lazer">üéÆ Lazer</option>
                                <option value="compras">üõí Compras</option>
                                <option value="servicos">üîß Servi√ßos</option>
                                <option value="outros_despesa">üì¶ Outros</option>
                            </optgroup>
                            <optgroup label="Receitas">
                                <option value="salario">üíº Sal√°rio</option>
                                <option value="freelance">üíª Freelance</option>
                                <option value="investimentos">üìà Investimentos</option>
                                <option value="presente">üéÅ Presente</option>
                                <option value="outros_receita">üí∞ Outros</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelEdit">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="filterModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Filtrar Transa√ß√µes</h3>
                <button class="modal-close" id="closeFilterModal">&times;</button>
            </div>
            <form id="filterForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="filterStartDate">Data In√≠cio</label>
                        <input type="date" id="filterStartDate">
                    </div>
                    <div class="form-group">
                        <label for="filterEndDate">Data Fim</label>
                        <input type="date" id="filterEndDate">
                    </div>
                </div>
                <div class="form-group">
                    <label for="filterType">Tipo</label>
                    <select id="filterType">
                        <option value="">Todos os tipos</option>
                        <option value="income">Receitas</option>
                        <option value="expense">Despesas</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="filterCategory">Categoria</label>
                    <select id="filterCategory">
                        <option value="">Todas as categorias</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" id="btnClearFilters" class="btn btn-secondary">Limpar Tudo</button>
                    <button type="button" id="btnApplyFilters" class="btn btn-primary">Aplicar Filtros</button>
                </div>
            </form>
        </div>
    </div>

    <div id="deleteModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>Confirmar Exclus√£o</h3>
                <button class="modal-close" id="closeDeleteModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja excluir esta transa√ß√£o?</p>
                <p class="delete-info" id="deleteInfo"></p>
            </div>
            <div class="modal-actions" id="defaultDeleteActions">
                <button class="btn btn-secondary" id="cancelDelete">Cancelar</button>
                <button class="btn btn-danger" id="confirmDelete">Excluir</button>
            </div>
            <div class="modal-actions column" id="seriesDeleteActions" style="display: none;">
                <p>Esta transa√ß√£o repete. Como excluir?</p>
                <button class="btn btn-secondary" id="deleteSingle">Apenas esta</button>
                <button class="btn btn-warning" id="deleteFuture">Esta e futuras</button>
                <button class="btn btn-danger" id="deleteAll">Todas as parcelas</button>
                <button class="btn btn-text cancel-series" id="cancelSeriesDelete">Cancelar</button>
            </div>
        </div>
    </div>

    <div id="seriesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Detalhes da S√©rie</h3>
                <button class="modal-close" id="closeSeriesModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="series-summary" id="seriesSummary"></div>
                <div class="series-list" id="seriesList">
                </div>
            </div>
        </div>
    </div>

    <div id="importModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3>Importar Dados</h3>
                <button class="modal-close" id="closeImportModal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Escolha como importar os dados:</p>
            </div>
            <div class="modal-actions import-actions">
                <button class="btn btn-secondary" id="cancelImport">Cancelar</button>
                <button class="btn btn-primary" id="mergeImport">Mesclar Dados</button>
                <button class="btn btn-danger" id="replaceImport">Substituir Tudo</button>
            </div>
        </div>
    </div>

    <div id="toast" class="toast"></div>
</body>

</html>